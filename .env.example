# Tippy Environment Variables Template
# Ledger Reference: Tippy Decision Ledger v1.0 (Final), Â§ 25 â€” Environment, Credentials & Secrets Management (Locked)
#
# âš ï¸ IMPORTANT: This file contains ONLY placeholders. No real secrets are included.
# Real values are managed via Doppler per Ledger Â§25.
#
# For local development:
# 1. Copy this file to .env.local (gitignored)
# 2. Fill in your values OR use Doppler CLI: `doppler run -- npm run dev`
# 3. Doppler is preferred per Ledger Â§25

# ============================================================================
# Environment & Server Configuration
# ============================================================================

# Node environment (development, staging, production)
NODE_ENV=development

# Server port (default: 3000)
PORT=3000

# ============================================================================
# Domain & URLs
# ============================================================================

# Base URL for the application (if needed for callbacks/webhooks)
# BASE_URL=https://your-domain.com

# ============================================================================
# Supabase / Database Configuration
# ============================================================================

# Supabase project URL
SUPABASE_URL=https://YOUR_SUPABASE_PROJECT.supabase.co

# Supabase anon key (for client-side operations)
SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY_HERE

# Supabase service role key (for server-side operations with elevated permissions)
SUPABASE_SERVICE_KEY=YOUR_SUPABASE_SERVICE_KEY_HERE

# Direct database connection URL (PostgreSQL connection string)
# Format: postgresql://user:password@host:port/database
SUPABASE_DB_URL=postgresql://postgres:YOUR_DB_PASSWORD@db.YOUR_SUPABASE_PROJECT.supabase.co:5432/postgres

# Alternative database URL (if using different naming)
DB_URL=postgresql://postgres:YOUR_DB_PASSWORD@db.YOUR_SUPABASE_PROJECT.supabase.co:5432/postgres

# Database password (used by Doppler scripts)
TIPPY_DB_URL=postgresql://postgres:YOUR_DB_PASSWORD@db.YOUR_SUPABASE_PROJECT.supabase.co:5432/postgres
TIPPY_DB_PASSWORD=YOUR_DB_PASSWORD_HERE

# JWT secret for Supabase token verification
SUPABASE_JWT_SECRET=YOUR_SUPABASE_JWT_SECRET_HERE

# JWT issuer (optional, for additional token validation)
# SUPABASE_JWT_ISSUER=https://YOUR_SUPABASE_PROJECT.supabase.co/auth/v1

# JWT audience (optional, for additional token validation)
# SUPABASE_JWT_AUDIENCE=authenticated

# ============================================================================
# Yoco Payment Processing
# ============================================================================

# Yoco API base URL (default: https://online.yoco.com/api/v1)
YOCO_API_URL=https://online.yoco.com/api/v1

# Yoco Test Keys (for development/test environments)
YOCO_TEST_PUBLIC_KEY=pk_test_YOUR_YOCO_TEST_PUBLIC_KEY_HERE
YOCO_TEST_SECRET_KEY=sk_test_YOUR_YOCO_TEST_SECRET_KEY_HERE

# Yoco Live Keys (for production environment)
YOCO_LIVE_PUBLIC_KEY=pk_live_YOUR_YOCO_LIVE_PUBLIC_KEY_HERE
YOCO_LIVE_SECRET_KEY=sk_live_YOUR_YOCO_LIVE_SECRET_KEY_HERE

# Yoco webhook signature secret (for webhook verification)
YOCO_WEBHOOK_SECRET=YOUR_YOCO_WEBHOOK_SECRET_HERE

# Yoco fee percentage (default: 0.00)
YOCO_FEE_PERCENT=0.00

# ============================================================================
# Fees & Calculations
# ============================================================================

# Platform fee percentage (default: 10.00)
PLATFORM_FEE_PERCENT=10.00

# VAT rate percentage (default: 15.00)
VAT_RATE_PERCENT=15.00

# ============================================================================
# SMS Configuration (SendGrid & Twilio)
# ============================================================================

# SMS provider (sendgrid or twilio, default: sendgrid)
SMS_PROVIDER=sendgrid

# SendGrid API key
SENDGRID_API_KEY=SG.YOUR_SENDGRID_API_KEY_HERE
TIPPY_SENDGRID_API_KEY=SG.YOUR_SENDGRID_API_KEY_HERE

# SendGrid sender phone number
SENDGRID_FROM_PHONE=+27123456789

# Twilio credentials
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=YOUR_TWILIO_AUTH_TOKEN_HERE
TWILIO_PHONE_NUMBER=+27123456789
TIPPY_TWILIO_API_KEY=YOUR_TWILIO_AUTH_TOKEN_HERE

# Welcome SMS sender ID (used as fallback if provider-specific from phone not set)
WELCOME_SMS_SENDER_ID=+27123456789

# Welcome SMS retry count (default: 3)
WELCOME_SMS_RETRY_COUNT=3

# Welcome SMS template ID (default: tippy_guard_welcome_v1)
WELCOME_SMS_TEMPLATE_ID=tippy_guard_welcome_v1

# Enable/disable welcome SMS (default: true, set to 'false' to disable)
SEND_GUARD_WELCOME_SMS=true

# ============================================================================
# Welcome SMS Configuration (Ledger Â§24.3)
# ============================================================================

# Weekly payout schedule day (default: Friday)
PAYOUT_WEEKLY_SCHEDULE=Friday

# Support phone number for welcome SMS (default: 060-123-4567)
SUPPORT_PHONE_NUMBER=060-123-4567

# ============================================================================
# Referral System Configuration
# ============================================================================

# Enable/disable referral system (default: true, set to 'false' to disable)
REFERRAL_ENABLED=true

# Referral milestone threshold in ZAR (default: 500.00 = R500)
# Guards must reach this lifetime gross tip amount for referrer to earn milestone
REFERRAL_MILESTONE_THRESHOLD_ZAR=500.00
# Alternative: REFERRAL_TIP_THRESHOLD_ZAR (legacy name)

# Referral milestone reward in ZAR (default: 20.00 = R20)
# Amount awarded to referrer when guard reaches milestone
REFERRAL_MILESTONE_REWARD_ZAR=20.00
# Alternative: REFERRAL_FEE_PER_GUARD_ZAR (legacy name)

# ============================================================================
# Referral Reversal Configuration (T+30 chargeback logic)
# ============================================================================

# Enable/disable referral reversal system (default: true)
REFERRAL_REVERSAL_ENABLED=true

# Reversal window in days (default: 30, for T+30 logic)
REFERRAL_REVERSAL_WINDOW_DAYS=30

# Check abuse flags when determining reversals (default: true)
REFERRAL_REVERSAL_CHECK_ABUSE_FLAGS=true

# Check guard activity status when determining reversals (default: true)
REFERRAL_REVERSAL_CHECK_GUARD_ACTIVITY=true

# Minimum guard lifetime gross retention ratio (default: 0.8 = 80%)
# If guard's lifetime gross drops below this % of milestone amount, reversal is triggered
REFERRAL_REVERSAL_MIN_GUARD_RETENTION=0.8

# ============================================================================
# Guard Registration Limits (Anti-abuse)
# ============================================================================

# Maximum guard registrations per referrer per day (default: 15)
GUARD_REGS_PER_REFERRER_PER_DAY=15

# Maximum guard registrations per device per day (default: 20)
GUARD_REGS_PER_DEVICE_PER_DAY=20

# Maximum guard registrations per IP address per hour (default: 30)
GUARD_REGS_PER_IP_PER_HOUR=30

# ============================================================================
# Payout Engine Configuration
# ============================================================================

# CashSend fee in ZAR cents (default: 900 = R9.00)
CASH_SEND_FEE_ZAR=900

# Minimum eligibility for payout in ZAR cents (default: 50000 = R500.00)
PAYOUT_MIN_ELIGIBILITY_ZAR=50000

# ============================================================================
# QR Code Configuration
# ============================================================================

# QR replacement fee in ZAR (default: 10.00 = R10)
QR_REPLACEMENT_FEE_ZAR=10.00

# ============================================================================
# Logging & Monitoring
# ============================================================================

# Sentry DSN for error tracking (optional)
SENTRY_DSN=https://YOUR_SENTRY_DSN_HERE@sentry.io/PROJECT_ID

# ============================================================================
# Doppler Configuration (for secrets management)
# ============================================================================

# Doppler service token (for runtime secret injection)
# DOPPLER_TOKEN=dp.st.YOUR_DOPPLER_TOKEN_HERE

# Doppler environment (development, staging, production)
# DOPPLER_ENVIRONMENT=development

# ============================================================================
# GitHub OAuth (if applicable)
# ============================================================================

# GitHub OAuth client secret (if using GitHub authentication)
# GITHUB_OAUTH_CLIENT_SECRET=YOUR_GITHUB_OAUTH_CLIENT_SECRET_HERE

# ============================================================================
# Notes
# ============================================================================
#
# 1. All real secrets are managed via Doppler per Ledger Â§25
# 2. For local development, use: `doppler run -- npm run dev`
# 3. Never commit real secrets to version control
# 4. This file serves as documentation of all required environment variables
# 5. Variables marked with # are optional and have defaults in code
# 6. Some variables have alternative names (e.g., REFERRAL_MILESTONE_THRESHOLD_ZAR vs REFERRAL_TIP_THRESHOLD_ZAR)
#    - The code checks both names for backward compatibility
